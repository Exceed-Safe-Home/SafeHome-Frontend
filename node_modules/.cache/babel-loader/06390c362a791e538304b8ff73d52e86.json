{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\projectapp\\\\src\\\\components\\\\MainStatusPage.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport \"./MainStatusPage.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport Button from \"react-bootstrap/Button\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { ProgressBar } from \"react-bootstrap\";\nimport returnPercentage from \"./functions/returnPercentage\";\nimport checkDangerLevel from \"./functions/checkDangerLevel\";\nimport PopUpAlert from \"./PopupAlert\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MainStatusPage = () => {\n  _s();\n\n  const [modalShow, setModalShow] = React.useState(false);\n  const navigate = useNavigate();\n  const myToken = localStorage.getItem(\"myToken\");\n  let showPopup = false;\n  const [sensorData, setSensorData] = React.useState({\n    water_level: 0,\n    gas: 2000,\n    smoke: 1800,\n    flame: 2700,\n    shake: 1\n  }); // eslint-disable-next-line no-unused-vars\n\n  let myInterval;\n  React.useEffect(() => {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    myInterval = setInterval(async () => await UpdateSensor(myToken), 10000);\n  }, []);\n\n  const UpdateSensor = async myToken => {\n    let response = await fetch(\"https://ecourse.cpe.ku.ac.th/exceed07/api/get_sensor\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/JSON\",\n        Authorization: `bearer ${myToken}`\n      }\n    });\n    response = await response.json();\n    console.log(response);\n    console.log(response.result.gas);\n\n    if (response.result.flame <= 300 && showPopup === false) {\n      console.log(\"hi\");\n      setModalShow(true);\n      showPopup = true;\n    }\n\n    if (showPopup === true) {\n      showPopup = setTimeout(() => false, 300000); //5 minutes cooldown\n    }\n\n    setSensorData({\n      water_level: response.result.water_level,\n      gas: response.result.gas,\n      smoke: response.result.smoke,\n      flame: response.result.flame,\n      shake: response.result.shake\n    }); // console.log(sensorData);\n    // setSensorData({\n    //   water_level: 800,\n    //   gas: 2500,\n    //   smoke: 1850,\n    //   flame: 200,\n    //   shake: 0,\n    // });\n    //test\n\n    if (sensorData.flame <= 300) {\n      console.log(\"Warning\");\n      setModalShow(true);\n    }\n  };\n\n  const onButtonClick = () => {\n    let interval_id = window.setInterval(() => {}, 99999);\n\n    for (let i = 0; i < interval_id; i++) window.clearInterval(i);\n\n    localStorage.clear(\"myToken\");\n    localStorage.clear(\"currentUser\");\n    navigate(\"/backtologin\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-page\",\n    children: [/*#__PURE__*/_jsxDEV(PopUpAlert, {\n      show: modalShow,\n      onHide: () => setModalShow(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"welcome-box\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Welcome back, \", localStorage.getItem(\"currentUser\"), \"!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-page-sensor\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-box\",\n        id: \"sensor-box-water\",\n        style: checkDangerLevel(sensorData.water_level, \"water_level\", \"back\"),\n        children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n          variant: checkDangerLevel(sensorData.water_level, \"water_level\", \"prog\"),\n          now: returnPercentage(sensorData.water_level, \"water_level\"),\n          label: `${returnPercentage(sensorData.water_level, \"water_level\")}%`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Water Level\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: checkDangerLevel(sensorData.water_level, \"water_level\", \"text\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-box\",\n        id: \"sensor-box-gas\",\n        style: checkDangerLevel(sensorData.gas, \"gas\", \"back\"),\n        children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n          variant: checkDangerLevel(sensorData.gas, \"gas\", \"prog\"),\n          now: returnPercentage(sensorData.gas, \"gas\"),\n          label: `${returnPercentage(sensorData.gas, \"gas\")}%`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Gas leakage\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: checkDangerLevel(sensorData.gas, \"gas\", \"text\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-box\",\n        id: \"sensor-box-smoke\",\n        style: checkDangerLevel(sensorData.smoke, \"smoke\", \"back\"),\n        children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n          variant: checkDangerLevel(sensorData.smoke, \"smoke\", \"prog\"),\n          now: returnPercentage(sensorData.smoke, \"smoke\"),\n          label: `${returnPercentage(sensorData.smoke, \"smoke\")}%`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Smoke Hazard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: checkDangerLevel(sensorData.smoke, \"smoke\", \"text\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-box\",\n        id: \"sensor-box-flame\",\n        style: checkDangerLevel(sensorData.flame, \"flame\", \"back\"),\n        children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n          variant: checkDangerLevel(sensorData.flame, \"flame\", \"prog\"),\n          now: returnPercentage(sensorData.flame, \"flame\"),\n          label: `${returnPercentage(sensorData.flame, \"flame\")}%`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Fire Hazard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: checkDangerLevel(sensorData.flame, \"flame\", \"text\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-box\",\n        id: \"sensor-box-shake\",\n        style: checkDangerLevel(sensorData.shake, \"shake\", \"back\"),\n        children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n          variant: checkDangerLevel(sensorData.shake, \"shake\", \"prog\"),\n          now: returnPercentage(sensorData.shake, \"shake\"),\n          label: `${returnPercentage(sensorData.shake, \"shake\")}%`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Earthquake\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: checkDangerLevel(sensorData.shake, \"shake\", \"text\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box-icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"logout-button-box\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          id: \"logout-button\",\n          type: \"submit\",\n          size: \"lg\",\n          variant: \"danger\",\n          onClick: onButtonClick,\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MainStatusPage, \"LQ5p25UJDgjTOlqTj9PHye7K/MM=\", false, function () {\n  return [useNavigate];\n});\n\n_c = MainStatusPage;\nexport default MainStatusPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainStatusPage\");","map":{"version":3,"sources":["C:/Users/user/Desktop/projectapp/src/components/MainStatusPage.js"],"names":["React","useNavigate","Button","ProgressBar","returnPercentage","checkDangerLevel","PopUpAlert","MainStatusPage","modalShow","setModalShow","useState","navigate","myToken","localStorage","getItem","showPopup","sensorData","setSensorData","water_level","gas","smoke","flame","shake","myInterval","useEffect","setInterval","UpdateSensor","response","fetch","method","headers","Authorization","json","console","log","result","setTimeout","onButtonClick","interval_id","window","i","clearInterval","clear"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,sBAAP;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,OAAO,sCAAP;AACA,SAASC,WAAT,QAA4B,iBAA5B;AACA,OAAOC,gBAAP,MAA6B,8BAA7B;AACA,OAAOC,gBAAP,MAA6B,8BAA7B;AACA,OAAOC,UAAP,MAAuB,cAAvB;;;AAEA,MAAMC,cAAc,GAAG,MAAM;AAAA;;AAC3B,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BT,KAAK,CAACU,QAAN,CAAe,KAAf,CAAlC;AAEA,QAAMC,QAAQ,GAAGV,WAAW,EAA5B;AACA,QAAMW,OAAO,GAAGC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAhB;AAEA,MAAIC,SAAS,GAAG,KAAhB;AAEA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BjB,KAAK,CAACU,QAAN,CAAe;AACjDQ,IAAAA,WAAW,EAAE,CADoC;AAEjDC,IAAAA,GAAG,EAAE,IAF4C;AAGjDC,IAAAA,KAAK,EAAE,IAH0C;AAIjDC,IAAAA,KAAK,EAAE,IAJ0C;AAKjDC,IAAAA,KAAK,EAAE;AAL0C,GAAf,CAApC,CAR2B,CAgB3B;;AACA,MAAIC,UAAJ;AACAvB,EAAAA,KAAK,CAACwB,SAAN,CAAgB,MAAM;AACpB;AACAD,IAAAA,UAAU,GAAGE,WAAW,CAAC,YAAY,MAAMC,YAAY,CAACd,OAAD,CAA/B,EAA0C,KAA1C,CAAxB;AACD,GAHD,EAGG,EAHH;;AAKA,QAAMc,YAAY,GAAG,MAAOd,OAAP,IAAmB;AACtC,QAAIe,QAAQ,GAAG,MAAMC,KAAK,CACxB,sDADwB,EAExB;AACEC,MAAAA,MAAM,EAAE,KADV;AAEEC,MAAAA,OAAO,EAAE;AACP,wBAAgB,kBADT;AAEPC,QAAAA,aAAa,EAAG,UAASnB,OAAQ;AAF1B;AAFX,KAFwB,CAA1B;AAUAe,IAAAA,QAAQ,GAAG,MAAMA,QAAQ,CAACK,IAAT,EAAjB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYP,QAAZ;AACAM,IAAAA,OAAO,CAACC,GAAR,CAAYP,QAAQ,CAACQ,MAAT,CAAgBhB,GAA5B;;AAEA,QAAIQ,QAAQ,CAACQ,MAAT,CAAgBd,KAAhB,IAAyB,GAAzB,IAAgCN,SAAS,KAAK,KAAlD,EAAyD;AACvDkB,MAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ;AACAzB,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACAM,MAAAA,SAAS,GAAG,IAAZ;AACD;;AAED,QAAGA,SAAS,KAAK,IAAjB,EAAsB;AAClBA,MAAAA,SAAS,GAAGqB,UAAU,CAAC,MAAM,KAAP,EAAc,MAAd,CAAtB,CADkB,CACyB;AAC9C;;AAEDnB,IAAAA,aAAa,CAAC;AACZC,MAAAA,WAAW,EAAES,QAAQ,CAACQ,MAAT,CAAgBjB,WADjB;AAEZC,MAAAA,GAAG,EAAEQ,QAAQ,CAACQ,MAAT,CAAgBhB,GAFT;AAGZC,MAAAA,KAAK,EAAEO,QAAQ,CAACQ,MAAT,CAAgBf,KAHX;AAIZC,MAAAA,KAAK,EAAEM,QAAQ,CAACQ,MAAT,CAAgBd,KAJX;AAKZC,MAAAA,KAAK,EAAEK,QAAQ,CAACQ,MAAT,CAAgBb;AALX,KAAD,CAAb,CAzBsC,CAiCtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIN,UAAU,CAACK,KAAX,IAAoB,GAAxB,EAA6B;AAC3BY,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAzB,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACD;AACF,GA/CD;;AAiDA,QAAM4B,aAAa,GAAG,MAAM;AAC1B,QAAIC,WAAW,GAAGC,MAAM,CAACd,WAAP,CAAmB,MAAM,CAAE,CAA3B,EAA6B,KAA7B,CAAlB;;AACA,SAAK,IAAIe,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,WAApB,EAAiCE,CAAC,EAAlC,EAAsCD,MAAM,CAACE,aAAP,CAAqBD,CAArB;;AACtC3B,IAAAA,YAAY,CAAC6B,KAAb,CAAmB,SAAnB;AACA7B,IAAAA,YAAY,CAAC6B,KAAb,CAAmB,aAAnB;AACA/B,IAAAA,QAAQ,CAAC,cAAD,CAAR;AACD,GAND;;AAQA,sBACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA,4BACE,QAAC,UAAD;AAAY,MAAA,IAAI,EAAEH,SAAlB;AAA6B,MAAA,MAAM,EAAE,MAAMC,YAAY,CAAC,KAAD;AAAvD;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAK,MAAA,KAAK,EAAC,aAAX;AAAA,6BACE;AAAA,qCAAmBI,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAFF,eAKE;AAAK,MAAA,SAAS,EAAC,kBAAf;AAAA,8BACE;AACE,QAAA,SAAS,EAAC,YADZ;AAEE,QAAA,EAAE,EAAC,kBAFL;AAGE,QAAA,KAAK,EAAET,gBAAgB,CACrBW,UAAU,CAACE,WADU,EAErB,aAFqB,EAGrB,MAHqB,CAHzB;AAAA,gCASE,QAAC,WAAD;AACE,UAAA,OAAO,EAAEb,gBAAgB,CACvBW,UAAU,CAACE,WADY,EAEvB,aAFuB,EAGvB,MAHuB,CAD3B;AAME,UAAA,GAAG,EAAEd,gBAAgB,CAACY,UAAU,CAACE,WAAZ,EAAyB,aAAzB,CANvB;AAOE,UAAA,KAAK,EAAG,GAAEd,gBAAgB,CACxBY,UAAU,CAACE,WADa,EAExB,aAFwB,CAGxB;AAVJ;AAAA;AAAA;AAAA;AAAA,gBATF,eAqBE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sBACGb,gBAAgB,CAACW,UAAU,CAACE,WAAZ,EAAyB,aAAzB,EAAwC,MAAxC;AADnB;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBArBF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eA6BE;AACE,QAAA,SAAS,EAAC,YADZ;AAEE,QAAA,EAAE,EAAC,gBAFL;AAGE,QAAA,KAAK,EAAEb,gBAAgB,CAACW,UAAU,CAACG,GAAZ,EAAiB,KAAjB,EAAwB,MAAxB,CAHzB;AAAA,gCAKE,QAAC,WAAD;AACE,UAAA,OAAO,EAAEd,gBAAgB,CAACW,UAAU,CAACG,GAAZ,EAAiB,KAAjB,EAAwB,MAAxB,CAD3B;AAEE,UAAA,GAAG,EAAEf,gBAAgB,CAACY,UAAU,CAACG,GAAZ,EAAiB,KAAjB,CAFvB;AAGE,UAAA,KAAK,EAAG,GAAEf,gBAAgB,CAACY,UAAU,CAACG,GAAZ,EAAiB,KAAjB,CAAwB;AAHpD;AAAA;AAAA;AAAA;AAAA,gBALF,eAUE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sBAAId,gBAAgB,CAACW,UAAU,CAACG,GAAZ,EAAiB,KAAjB,EAAwB,MAAxB;AAApB;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAVF,eAcE;AAAK,UAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,gBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,cA7BF,eA6CE;AACE,QAAA,SAAS,EAAC,YADZ;AAEE,QAAA,EAAE,EAAC,kBAFL;AAGE,QAAA,KAAK,EAAEd,gBAAgB,CAACW,UAAU,CAACI,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B,CAHzB;AAAA,gCAKE,QAAC,WAAD;AACE,UAAA,OAAO,EAAEf,gBAAgB,CAACW,UAAU,CAACI,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B,CAD3B;AAEE,UAAA,GAAG,EAAEhB,gBAAgB,CAACY,UAAU,CAACI,KAAZ,EAAmB,OAAnB,CAFvB;AAGE,UAAA,KAAK,EAAG,GAAEhB,gBAAgB,CAACY,UAAU,CAACI,KAAZ,EAAmB,OAAnB,CAA4B;AAHxD;AAAA;AAAA;AAAA;AAAA,gBALF,eAUE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sBAAIf,gBAAgB,CAACW,UAAU,CAACI,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B;AAApB;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAVF,eAcE;AAAK,UAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,gBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,cA7CF,eA6DE;AACE,QAAA,SAAS,EAAC,YADZ;AAEE,QAAA,EAAE,EAAC,kBAFL;AAGE,QAAA,KAAK,EAAEf,gBAAgB,CAACW,UAAU,CAACK,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B,CAHzB;AAAA,gCAKE,QAAC,WAAD;AACE,UAAA,OAAO,EAAEhB,gBAAgB,CAACW,UAAU,CAACK,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B,CAD3B;AAEE,UAAA,GAAG,EAAEjB,gBAAgB,CAACY,UAAU,CAACK,KAAZ,EAAmB,OAAnB,CAFvB;AAGE,UAAA,KAAK,EAAG,GAAEjB,gBAAgB,CAACY,UAAU,CAACK,KAAZ,EAAmB,OAAnB,CAA4B;AAHxD;AAAA;AAAA;AAAA;AAAA,gBALF,eAUE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sBAAIhB,gBAAgB,CAACW,UAAU,CAACK,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B;AAApB;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAVF,eAcE;AAAK,UAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,gBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,cA7DF,eA6EE;AACE,QAAA,SAAS,EAAC,YADZ;AAEE,QAAA,EAAE,EAAC,kBAFL;AAGE,QAAA,KAAK,EAAEhB,gBAAgB,CAACW,UAAU,CAACM,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B,CAHzB;AAAA,gCAKE,QAAC,WAAD;AACE,UAAA,OAAO,EAAEjB,gBAAgB,CAACW,UAAU,CAACM,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B,CAD3B;AAEE,UAAA,GAAG,EAAElB,gBAAgB,CAACY,UAAU,CAACM,KAAZ,EAAmB,OAAnB,CAFvB;AAGE,UAAA,KAAK,EAAG,GAAElB,gBAAgB,CAACY,UAAU,CAACM,KAAZ,EAAmB,OAAnB,CAA4B;AAHxD;AAAA;AAAA;AAAA;AAAA,gBALF,eAUE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sBAAIjB,gBAAgB,CAACW,UAAU,CAACM,KAAZ,EAAmB,OAAnB,EAA4B,MAA5B;AAApB;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAVF,eAcE;AAAK,UAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,gBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,cA7EF,eA8FE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA,+BACE,QAAC,MAAD;AACE,UAAA,EAAE,EAAC,eADL;AAEE,UAAA,IAAI,EAAC,QAFP;AAGE,UAAA,IAAI,EAAC,IAHP;AAIE,UAAA,OAAO,EAAC,QAJV;AAKE,UAAA,OAAO,EAAEe,aALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cA9FF;AAAA;AAAA;AAAA;AAAA;AAAA,YALF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAkHD,CAlMD;;GAAM9B,c;UAGaN,W;;;KAHbM,c;AAoMN,eAAeA,cAAf","sourcesContent":["import React from \"react\";\r\nimport \"./MainStatusPage.css\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { ProgressBar } from \"react-bootstrap\";\r\nimport returnPercentage from \"./functions/returnPercentage\";\r\nimport checkDangerLevel from \"./functions/checkDangerLevel\";\r\nimport PopUpAlert from \"./PopupAlert\";\r\n\r\nconst MainStatusPage = () => {\r\n  const [modalShow, setModalShow] = React.useState(false);\r\n\r\n  const navigate = useNavigate();\r\n  const myToken = localStorage.getItem(\"myToken\");\r\n\r\n  let showPopup = false;\r\n\r\n  const [sensorData, setSensorData] = React.useState({\r\n    water_level: 0,\r\n    gas: 2000,\r\n    smoke: 1800,\r\n    flame: 2700,\r\n    shake: 1,\r\n  });\r\n\r\n  // eslint-disable-next-line no-unused-vars\r\n  let myInterval;\r\n  React.useEffect(() => {\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    myInterval = setInterval(async () => await UpdateSensor(myToken), 10000);\r\n  }, []);\r\n\r\n  const UpdateSensor = async (myToken) => {\r\n    let response = await fetch(\r\n      \"https://ecourse.cpe.ku.ac.th/exceed07/api/get_sensor\",\r\n      {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/JSON\",\r\n          Authorization: `bearer ${myToken}`,\r\n        },\r\n      }\r\n    );\r\n    response = await response.json();\r\n    console.log(response)\r\n    console.log(response.result.gas)\r\n\r\n    if (response.result.flame <= 300 && showPopup === false) {\r\n      console.log(\"hi\")\r\n      setModalShow(true);\r\n      showPopup = true;\r\n    }\r\n    \r\n    if(showPopup === true){\r\n        showPopup = setTimeout(() => false, 300000)//5 minutes cooldown\r\n    }\r\n\r\n    setSensorData({\r\n      water_level: response.result.water_level,\r\n      gas: response.result.gas,\r\n      smoke: response.result.smoke,\r\n      flame: response.result.flame,\r\n      shake: response.result.shake\r\n    })\r\n\r\n    // console.log(sensorData);\r\n    // setSensorData({\r\n    //   water_level: 800,\r\n    //   gas: 2500,\r\n    //   smoke: 1850,\r\n    //   flame: 200,\r\n    //   shake: 0,\r\n    // });\r\n    //test\r\n\r\n    if (sensorData.flame <= 300) {\r\n      console.log(\"Warning\")\r\n      setModalShow(true);\r\n    }\r\n  };\r\n\r\n  const onButtonClick = () => {\r\n    let interval_id = window.setInterval(() => {}, 99999);\r\n    for (let i = 0; i < interval_id; i++) window.clearInterval(i);\r\n    localStorage.clear(\"myToken\");\r\n    localStorage.clear(\"currentUser\");\r\n    navigate(\"/backtologin\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"main-page\">\r\n      <PopUpAlert show={modalShow} onHide={() => setModalShow(false)} />\r\n      <div class=\"welcome-box\">\r\n        <h2>Welcome back, {localStorage.getItem(\"currentUser\")}!</h2>\r\n      </div>\r\n      <div className=\"main-page-sensor\">\r\n        <div\r\n          className=\"sensor-box\"\r\n          id=\"sensor-box-water\"\r\n          style={checkDangerLevel(\r\n            sensorData.water_level,\r\n            \"water_level\",\r\n            \"back\"\r\n          )}\r\n        >\r\n          <ProgressBar\r\n            variant={checkDangerLevel(\r\n              sensorData.water_level,\r\n              \"water_level\",\r\n              \"prog\"\r\n            )}\r\n            now={returnPercentage(sensorData.water_level, \"water_level\")}\r\n            label={`${returnPercentage(\r\n              sensorData.water_level,\r\n              \"water_level\"\r\n            )}%`}\r\n          />\r\n          <div className=\"sensor-box-text\">\r\n            <p>Water Level</p>\r\n            <p>\r\n              {checkDangerLevel(sensorData.water_level, \"water_level\", \"text\")}\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"sensor-box\"\r\n          id=\"sensor-box-gas\"\r\n          style={checkDangerLevel(sensorData.gas, \"gas\", \"back\")}\r\n        >\r\n          <ProgressBar\r\n            variant={checkDangerLevel(sensorData.gas, \"gas\", \"prog\")}\r\n            now={returnPercentage(sensorData.gas, \"gas\")}\r\n            label={`${returnPercentage(sensorData.gas, \"gas\")}%`}\r\n          />\r\n          <div className=\"sensor-box-text\">\r\n            <p>Gas leakage</p>\r\n            <p>{checkDangerLevel(sensorData.gas, \"gas\", \"text\")}</p>\r\n          </div>\r\n          <div className=\"sensor-box-icon\"></div>\r\n        </div>\r\n        <div\r\n          className=\"sensor-box\"\r\n          id=\"sensor-box-smoke\"\r\n          style={checkDangerLevel(sensorData.smoke, \"smoke\", \"back\")}\r\n        >\r\n          <ProgressBar\r\n            variant={checkDangerLevel(sensorData.smoke, \"smoke\", \"prog\")}\r\n            now={returnPercentage(sensorData.smoke, \"smoke\")}\r\n            label={`${returnPercentage(sensorData.smoke, \"smoke\")}%`}\r\n          />\r\n          <div className=\"sensor-box-text\">\r\n            <p>Smoke Hazard</p>\r\n            <p>{checkDangerLevel(sensorData.smoke, \"smoke\", \"text\")}</p>\r\n          </div>\r\n          <div className=\"sensor-box-icon\"></div>\r\n        </div>\r\n        <div\r\n          className=\"sensor-box\"\r\n          id=\"sensor-box-flame\"\r\n          style={checkDangerLevel(sensorData.flame, \"flame\", \"back\")}\r\n        >\r\n          <ProgressBar\r\n            variant={checkDangerLevel(sensorData.flame, \"flame\", \"prog\")}\r\n            now={returnPercentage(sensorData.flame, \"flame\")}\r\n            label={`${returnPercentage(sensorData.flame, \"flame\")}%`}\r\n          />\r\n          <div className=\"sensor-box-text\">\r\n            <p>Fire Hazard</p>\r\n            <p>{checkDangerLevel(sensorData.flame, \"flame\", \"text\")}</p>\r\n          </div>\r\n          <div className=\"sensor-box-icon\"></div>\r\n        </div>\r\n        <div\r\n          className=\"sensor-box\"\r\n          id=\"sensor-box-shake\"\r\n          style={checkDangerLevel(sensorData.shake, \"shake\", \"back\")}\r\n        >\r\n          <ProgressBar\r\n            variant={checkDangerLevel(sensorData.shake, \"shake\", \"prog\")}\r\n            now={returnPercentage(sensorData.shake, \"shake\")}\r\n            label={`${returnPercentage(sensorData.shake, \"shake\")}%`}\r\n          />\r\n          <div className=\"sensor-box-text\">\r\n            <p>Earthquake</p>\r\n            <p>{checkDangerLevel(sensorData.shake, \"shake\", \"text\")}</p>\r\n          </div>\r\n          <div className=\"sensor-box-icon\"></div>\r\n        </div>\r\n\r\n        <div className=\"logout-button-box\">\r\n          <Button\r\n            id=\"logout-button\"\r\n            type=\"submit\"\r\n            size=\"lg\"\r\n            variant=\"danger\"\r\n            onClick={onButtonClick}\r\n          >\r\n            Logout\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MainStatusPage;\r\n"]},"metadata":{},"sourceType":"module"}