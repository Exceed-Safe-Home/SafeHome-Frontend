{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\projectapp\\\\src\\\\components\\\\MainStatusPage.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport \"./MainStatusPage.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport Button from \"react-bootstrap/Button\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { ProgressBar } from \"react-bootstrap\";\nimport returnPercentage from \"./functions/returnPercentage\";\nimport checkDangerLevel from \"./functions/checkDangerLevel\";\nimport PopUpAlert from \"./PopupAlert\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MainStatusPage = () => {\n  _s();\n\n  const [modalShow, setModalShow] = React.useState(false);\n  const navigate = useNavigate();\n  const myToken = localStorage.getItem(\"myToken\");\n  let popUpOnCooldown = false;\n  const [sensorData, setSensorData] = React.useState({\n    water_level: 0,\n    gas: 2000,\n    smoke: 1800,\n    flame: 2700,\n    shake: 1\n  });\n  const [address, setAddress] = React.useState({\n    house_no: \"\",\n    village_no: \"\",\n    lane: \"\",\n    road: \"\",\n    sub_district: \"\",\n    district: \"\",\n    province: \"\"\n  }); // eslint-disable-next-line no-unused-vars\n\n  let myInterval;\n  React.useEffect(() => {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    myInterval = setInterval(async () => await UpdateSensor(myToken), 1000);\n  }, []);\n\n  const UpdateSensor = async myToken => {\n    let response = await fetch(\"https://ecourse.cpe.ku.ac.th/exceed07/api/get_sensor\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/JSON\",\n        Authorization: `bearer ${myToken}`\n      }\n    });\n    response = await response.json();\n    console.log(response);\n    console.log(response.result.gas);\n\n    if (response.result.flame <= 300 && popUpOnCooldown === false) {\n      let address = await fetch(\"https://ecourse.cpe.ku.ac.th/exceed07/api/get_address\", {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/JSON\",\n          Authorization: `bearer ${myToken}`\n        }\n      });\n      address = await address.json();\n      console.log(\"Warning Logged\");\n      console.log(address);\n      setAddress({\n        house_no: address.result.house_no,\n        village_no: address.result.village_no,\n        lane: address.result.lane,\n        road: address.result.road,\n        sub_district: address.result.sub_district,\n        district: address.result.district,\n        province: address.result.province\n      });\n      setModalShow(true);\n      popUpOnCooldown = true;\n    }\n\n    if (popUpOnCooldown === true) {\n      popUpOnCooldown = setTimeout(() => false, 300000); //5 minutes cooldown\n    }\n\n    setSensorData({\n      water_level: response.result.water_level,\n      gas: response.result.gas,\n      smoke: response.result.smoke,\n      flame: response.result.flame,\n      shake: response.result.shake\n    }); // setSensorData({\n    //   water_level: 1700,\n    //   gas: 2500,\n    //   smoke: 1850,\n    //   flame: 200,\n    //   shake: 0,\n    // });\n    // test\n  };\n\n  const onButtonClick = () => {\n    let interval_id = window.setInterval(() => {}, 99999);\n\n    for (let i = 0; i < interval_id; i++) window.clearInterval(i);\n\n    localStorage.clear(\"myToken\");\n    localStorage.clear(\"currentUser\");\n    navigate(\"/backtologin\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-page\",\n    children: [/*#__PURE__*/_jsxDEV(PopUpAlert, {\n      show: modalShow,\n      onHide: () => setModalShow(false),\n      details: address\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"welcome-box\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Welcome back, \", localStorage.getItem(\"currentUser\"), \"!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-page-sensor\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-big-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-box\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"waterlevel.png\",\n            alt: \"water-level-pic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box\",\n          id: \"sensor-box-water\",\n          style: checkDangerLevel(sensorData.water_level, \"water_level\", \"back\"),\n          children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n            variant: checkDangerLevel(sensorData.water_level, \"water_level\", \"prog\"),\n            now: returnPercentage(sensorData.water_level, \"water_level\"),\n            label: `${returnPercentage(sensorData.water_level, \"water_level\")}%`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Water Level\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: checkDangerLevel(sensorData.water_level, \"water_level\", \"text\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-big-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-box\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"download.png\",\n            alt: \"water-level-pic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box\",\n          id: \"sensor-box-gas\",\n          style: checkDangerLevel(sensorData.gas, \"gas\", \"back\"),\n          children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n            variant: checkDangerLevel(sensorData.gas, \"gas\", \"prog\"),\n            now: returnPercentage(sensorData.gas, \"gas\"),\n            label: `${returnPercentage(sensorData.gas, \"gas\")}%`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Gas leakage\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: checkDangerLevel(sensorData.gas, \"gas\", \"text\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-big-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-box\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"smoke.jfif\",\n            alt: \"water-level-pic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box\",\n          id: \"sensor-box-smoke\",\n          style: checkDangerLevel(sensorData.smoke, \"smoke\", \"back\"),\n          children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n            variant: checkDangerLevel(sensorData.smoke, \"smoke\", \"prog\"),\n            now: returnPercentage(sensorData.smoke, \"smoke\"),\n            label: `${returnPercentage(sensorData.smoke, \"smoke\")}%`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Smoke Hazard\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: checkDangerLevel(sensorData.smoke, \"smoke\", \"text\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-big-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-box\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"flame.jfif\",\n            alt: \"water-level-pic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box\",\n          id: \"sensor-box-flame\",\n          style: checkDangerLevel(sensorData.flame, \"flame\", \"back\"),\n          children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n            variant: checkDangerLevel(sensorData.flame, \"flame\", \"prog\"),\n            now: returnPercentage(sensorData.flame, \"flame\"),\n            label: `${returnPercentage(sensorData.flame, \"flame\")}%`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Fire Hazard\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: checkDangerLevel(sensorData.flame, \"flame\", \"text\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sensor-big-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-box\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"quake.jfif\",\n            alt: \"quake-pic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sensor-box\",\n          id: \"sensor-box-shake\",\n          style: checkDangerLevel(sensorData.shake, \"shake\", \"back\"),\n          children: [/*#__PURE__*/_jsxDEV(ProgressBar, {\n            variant: checkDangerLevel(sensorData.shake, \"shake\", \"prog\"),\n            now: returnPercentage(sensorData.shake, \"shake\"),\n            label: `${returnPercentage(sensorData.shake, \"shake\")}%`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sensor-box-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Earthquake\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: checkDangerLevel(sensorData.shake, \"shake\", \"text\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"logout-button-box\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          id: \"logout-button\",\n          type: \"submit\",\n          size: \"lg\",\n          variant: \"danger\",\n          onClick: onButtonClick,\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MainStatusPage, \"sx4tAunrXAWgdHYhsZ8bY1oTh7w=\", false, function () {\n  return [useNavigate];\n});\n\n_c = MainStatusPage;\nexport default MainStatusPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainStatusPage\");","map":{"version":3,"sources":["C:/Users/user/Desktop/projectapp/src/components/MainStatusPage.js"],"names":["React","useNavigate","Button","ProgressBar","returnPercentage","checkDangerLevel","PopUpAlert","MainStatusPage","modalShow","setModalShow","useState","navigate","myToken","localStorage","getItem","popUpOnCooldown","sensorData","setSensorData","water_level","gas","smoke","flame","shake","address","setAddress","house_no","village_no","lane","road","sub_district","district","province","myInterval","useEffect","setInterval","UpdateSensor","response","fetch","method","headers","Authorization","json","console","log","result","setTimeout","onButtonClick","interval_id","window","i","clearInterval","clear"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./MainStatusPage.css\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { ProgressBar } from \"react-bootstrap\";\r\nimport returnPercentage from \"./functions/returnPercentage\";\r\nimport checkDangerLevel from \"./functions/checkDangerLevel\";\r\nimport PopUpAlert from \"./PopupAlert\";\r\n\r\nconst MainStatusPage = () => {\r\n  const [modalShow, setModalShow] = React.useState(false);\r\n\r\n  const navigate = useNavigate();\r\n  const myToken = localStorage.getItem(\"myToken\");\r\n\r\n  let popUpOnCooldown = false;\r\n\r\n  const [sensorData, setSensorData] = React.useState({\r\n    water_level: 0,\r\n    gas: 2000,\r\n    smoke: 1800,\r\n    flame: 2700,\r\n    shake: 1,\r\n  });\r\n\r\n  const [address, setAddress] = React.useState({\r\n    house_no: \"\",\r\n    village_no: \"\",\r\n    lane: \"\",\r\n    road: \"\",\r\n    sub_district: \"\",\r\n    district: \"\",\r\n    province: \"\",\r\n  });\r\n\r\n  // eslint-disable-next-line no-unused-vars\r\n  let myInterval;\r\n  React.useEffect(() => {\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    myInterval = setInterval(async () => await UpdateSensor(myToken), 1000);\r\n  }, []);\r\n\r\n  const UpdateSensor = async (myToken) => {\r\n    let response = await fetch(\r\n      \"https://ecourse.cpe.ku.ac.th/exceed07/api/get_sensor\",\r\n      {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/JSON\",\r\n          Authorization: `bearer ${myToken}`,\r\n        },\r\n      }\r\n    );\r\n    response = await response.json();\r\n    console.log(response);\r\n    console.log(response.result.gas);\r\n\r\n    if (response.result.flame <= 300 && popUpOnCooldown === false) {\r\n      let address = await fetch(\r\n        \"https://ecourse.cpe.ku.ac.th/exceed07/api/get_address\",\r\n        {\r\n          method: \"GET\",\r\n          headers: {\r\n            \"Content-Type\": \"application/JSON\",\r\n            Authorization: `bearer ${myToken}`,\r\n          },\r\n        }\r\n      );\r\n      address = await address.json();\r\n\r\n      console.log(\"Warning Logged\");\r\n      console.log(address);\r\n\r\n      setAddress({\r\n        house_no: address.result.house_no,\r\n        village_no: address.result.village_no,\r\n        lane: address.result.lane,\r\n        road: address.result.road,\r\n        sub_district: address.result.sub_district,\r\n        district: address.result.district,\r\n        province: address.result.province,\r\n      });\r\n\r\n      setModalShow(true);\r\n      popUpOnCooldown = true;\r\n    }\r\n\r\n    if (popUpOnCooldown === true) {\r\n      popUpOnCooldown = setTimeout(() => false, 300000); //5 minutes cooldown\r\n    }\r\n\r\n    setSensorData({\r\n      water_level: response.result.water_level,\r\n      gas: response.result.gas,\r\n      smoke: response.result.smoke,\r\n      flame: response.result.flame,\r\n      shake: response.result.shake,\r\n    });\r\n\r\n    // setSensorData({\r\n    //   water_level: 1700,\r\n    //   gas: 2500,\r\n    //   smoke: 1850,\r\n    //   flame: 200,\r\n    //   shake: 0,\r\n    // });\r\n    // test\r\n  };\r\n\r\n  const onButtonClick = () => {\r\n    let interval_id = window.setInterval(() => {}, 99999);\r\n    for (let i = 0; i < interval_id; i++) window.clearInterval(i);\r\n    localStorage.clear(\"myToken\");\r\n    localStorage.clear(\"currentUser\");\r\n    navigate(\"/backtologin\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"main-page\">\r\n      <PopUpAlert\r\n        show={modalShow}\r\n        onHide={() => setModalShow(false)}\r\n        details={address}\r\n      />\r\n      <div class=\"welcome-box\">\r\n        <h2>Welcome back, {localStorage.getItem(\"currentUser\")}!</h2>\r\n      </div>\r\n      <div className=\"main-page-sensor\">\r\n        <div className=\"sensor-big-box\">\r\n          <div className=\"image-box\">\r\n            <img src=\"waterlevel.png\" alt=\"water-level-pic\"></img>\r\n          </div>\r\n          <div\r\n            className=\"sensor-box\"\r\n            id=\"sensor-box-water\"\r\n            style={checkDangerLevel(\r\n              sensorData.water_level,\r\n              \"water_level\",\r\n              \"back\"\r\n            )}\r\n          >\r\n            <ProgressBar\r\n              variant={checkDangerLevel(\r\n                sensorData.water_level,\r\n                \"water_level\",\r\n                \"prog\"\r\n              )}\r\n              now={returnPercentage(sensorData.water_level, \"water_level\")}\r\n              label={`${returnPercentage(\r\n                sensorData.water_level,\r\n                \"water_level\"\r\n              )}%`}\r\n            />\r\n            <div className=\"sensor-box-text\">\r\n              <p>Water Level</p>\r\n              <p>\r\n                {checkDangerLevel(\r\n                  sensorData.water_level,\r\n                  \"water_level\",\r\n                  \"text\"\r\n                )}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"sensor-big-box\">\r\n          <div className=\"image-box\">\r\n            <img src=\"download.png\" alt=\"water-level-pic\"></img>\r\n          </div>\r\n          <div\r\n            className=\"sensor-box\"\r\n            id=\"sensor-box-gas\"\r\n            style={checkDangerLevel(sensorData.gas, \"gas\", \"back\")}\r\n          >\r\n            <ProgressBar\r\n              variant={checkDangerLevel(sensorData.gas, \"gas\", \"prog\")}\r\n              now={returnPercentage(sensorData.gas, \"gas\")}\r\n              label={`${returnPercentage(sensorData.gas, \"gas\")}%`}\r\n            />\r\n            <div className=\"sensor-box-text\">\r\n              <p>Gas leakage</p>\r\n              <p>{checkDangerLevel(sensorData.gas, \"gas\", \"text\")}</p>\r\n            </div>\r\n            <div className=\"sensor-box-icon\"></div>\r\n          </div>\r\n        </div>\r\n        <div className=\"sensor-big-box\">\r\n          <div className=\"image-box\">\r\n            <img src=\"smoke.jfif\" alt=\"water-level-pic\"></img>\r\n          </div>\r\n          <div\r\n            className=\"sensor-box\"\r\n            id=\"sensor-box-smoke\"\r\n            style={checkDangerLevel(sensorData.smoke, \"smoke\", \"back\")}\r\n          >\r\n            <ProgressBar\r\n              variant={checkDangerLevel(sensorData.smoke, \"smoke\", \"prog\")}\r\n              now={returnPercentage(sensorData.smoke, \"smoke\")}\r\n              label={`${returnPercentage(sensorData.smoke, \"smoke\")}%`}\r\n            />\r\n            <div className=\"sensor-box-text\">\r\n              <p>Smoke Hazard</p>\r\n              <p>{checkDangerLevel(sensorData.smoke, \"smoke\", \"text\")}</p>\r\n            </div>\r\n            <div className=\"sensor-box-icon\"></div>\r\n          </div>\r\n        </div>\r\n        <div className=\"sensor-big-box\">\r\n          <div className=\"image-box\">\r\n            <img src=\"flame.jfif\" alt=\"water-level-pic\"></img>\r\n          </div>\r\n          <div\r\n            className=\"sensor-box\"\r\n            id=\"sensor-box-flame\"\r\n            style={checkDangerLevel(sensorData.flame, \"flame\", \"back\")}\r\n          >\r\n            <ProgressBar\r\n              variant={checkDangerLevel(sensorData.flame, \"flame\", \"prog\")}\r\n              now={returnPercentage(sensorData.flame, \"flame\")}\r\n              label={`${returnPercentage(sensorData.flame, \"flame\")}%`}\r\n            />\r\n            <div className=\"sensor-box-text\">\r\n              <p>Fire Hazard</p>\r\n              <p>{checkDangerLevel(sensorData.flame, \"flame\", \"text\")}</p>\r\n            </div>\r\n            <div className=\"sensor-box-icon\"></div>\r\n          </div>\r\n        </div>\r\n        <div className=\"sensor-big-box\">\r\n          <div className=\"image-box\">\r\n            <img src=\"quake.jfif\" alt=\"quake-pic\"></img>\r\n          </div>\r\n          <div\r\n            className=\"sensor-box\"\r\n            id=\"sensor-box-shake\"\r\n            style={checkDangerLevel(sensorData.shake, \"shake\", \"back\")}\r\n          >\r\n            <ProgressBar\r\n              variant={checkDangerLevel(sensorData.shake, \"shake\", \"prog\")}\r\n              now={returnPercentage(sensorData.shake, \"shake\")}\r\n              label={`${returnPercentage(sensorData.shake, \"shake\")}%`}\r\n            />\r\n            <div className=\"sensor-box-text\">\r\n              <p>Earthquake</p>\r\n              <p>{checkDangerLevel(sensorData.shake, \"shake\", \"text\")}</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"logout-button-box\">\r\n          <Button\r\n            id=\"logout-button\"\r\n            type=\"submit\"\r\n            size=\"lg\"\r\n            variant=\"danger\"\r\n            onClick={onButtonClick}\r\n          >\r\n            Logout\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MainStatusPage;\r\n"]},"metadata":{},"sourceType":"module"}